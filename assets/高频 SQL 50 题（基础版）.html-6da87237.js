import{_ as c}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as i,c as l,b as e,d as t,e as s,f as a}from"./app-45dbace8.js";const d={},r=e("h1",{id:"高频-sql-50-题",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#高频-sql-50-题","aria-hidden":"true"},"#"),t(" 高频 SQL 50 题")],-1),u={href:"https://leetcode.cn/studyplan/sql-free-50/",target:"_blank",rel:"noopener noreferrer"},k=e("h2",{id:"查询",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#查询","aria-hidden":"true"},"#"),t(" 查询")],-1),v=e("h3",{id:"_1757-可回收且低脂的产品",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_1757-可回收且低脂的产品","aria-hidden":"true"},"#"),t(" 1757. 可回收且低脂的产品")],-1),m=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> product_id
<span class="token keyword">FROM</span> Products
<span class="token keyword">WHERE</span> low_fats <span class="token operator">=</span> <span class="token string">&#39;Y&#39;</span> <span class="token operator">AND</span> recyclable <span class="token operator">=</span> <span class="token string">&#39;Y&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_584-寻找用户推荐人" tabindex="-1"><a class="header-anchor" href="#_584-寻找用户推荐人" aria-hidden="true">#</a> 584. 寻找用户推荐人</h3>`,2),b=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> name 
<span class="token keyword">from</span> Customer 
<span class="token keyword">where</span> referee_id <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> referee_id <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_595-大的国家" tabindex="-1"><a class="header-anchor" href="#_595-大的国家" aria-hidden="true">#</a> 595. 大的国家</h3>`,2),h=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> name<span class="token punctuation">,</span>population<span class="token punctuation">,</span>area 
<span class="token keyword">from</span> World 
<span class="token keyword">where</span> area <span class="token operator">&gt;=</span> <span class="token number">3000000</span> <span class="token operator">or</span> population <span class="token operator">&gt;=</span> <span class="token number">25000000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1148-文章浏览-i" tabindex="-1"><a class="header-anchor" href="#_1148-文章浏览-i" aria-hidden="true">#</a> 1148. 文章浏览 I</h3>`,2),y=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token keyword">DISTINCT</span> author_id <span class="token string">&#39;id&#39;</span> 
<span class="token keyword">from</span> Views 
<span class="token keyword">where</span> author_id <span class="token operator">=</span> viewer_id 
<span class="token keyword">order</span> <span class="token keyword">by</span> author_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1683-无效的推文" tabindex="-1"><a class="header-anchor" href="#_1683-无效的推文" aria-hidden="true">#</a> 1683. 无效的推文</h3>`,2),_=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> tweet_id 
<span class="token keyword">from</span> Tweets 
<span class="token keyword">where</span> LENGTH<span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">15</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="连接" tabindex="-1"><a class="header-anchor" href="#连接" aria-hidden="true">#</a> 连接</h2><h3 id="_1378-使用唯一标识码替换员工id" tabindex="-1"><a class="header-anchor" href="#_1378-使用唯一标识码替换员工id" aria-hidden="true">#</a> 1378. 使用唯一标识码替换员工ID</h3>`,3),w=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> b<span class="token punctuation">.</span>unique_id<span class="token punctuation">,</span>a<span class="token punctuation">.</span>name 
<span class="token keyword">from</span> Employees a <span class="token keyword">left</span> <span class="token keyword">join</span> EmployeeUNI b 
<span class="token keyword">on</span> a<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1068-产品销售分析-i" tabindex="-1"><a class="header-anchor" href="#_1068-产品销售分析-i" aria-hidden="true">#</a> 1068. 产品销售分析 I</h3>`,2),g=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> p<span class="token punctuation">.</span>product_name<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token keyword">year</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>price 
<span class="token keyword">from</span> Sales s <span class="token punctuation">,</span> Product p
<span class="token keyword">where</span>  s<span class="token punctuation">.</span>product_id <span class="token operator">=</span> p<span class="token punctuation">.</span>product_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1581-进店却未进行过交易的顾客" tabindex="-1"><a class="header-anchor" href="#_1581-进店却未进行过交易的顾客" aria-hidden="true">#</a> 1581. 进店却未进行过交易的顾客</h3>`,2),f=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> v<span class="token punctuation">.</span>customer_id<span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span>customer_id<span class="token punctuation">)</span> count_no_trans
<span class="token keyword">from</span> Visits v <span class="token keyword">left</span> <span class="token keyword">join</span> <span class="token keyword">Transactions</span> t
<span class="token keyword">on</span> t<span class="token punctuation">.</span>visit_id <span class="token operator">=</span> v<span class="token punctuation">.</span>visit_id
<span class="token keyword">where</span> t<span class="token punctuation">.</span>visit_id <span class="token operator">is</span> <span class="token boolean">null</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> customer_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_197-上升的温度" tabindex="-1"><a class="header-anchor" href="#_197-上升的温度" aria-hidden="true">#</a> 197. 上升的温度</h3>`,2),x=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> w1<span class="token punctuation">.</span>id Id
<span class="token keyword">from</span> Weather w1<span class="token punctuation">,</span>Weather w2
<span class="token keyword">where</span> DATEDIFF<span class="token punctuation">(</span>w1<span class="token punctuation">.</span>recordDate<span class="token punctuation">,</span>w2<span class="token punctuation">.</span>recordDate<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">and</span> w1<span class="token punctuation">.</span>temperature <span class="token operator">&gt;</span> w2<span class="token punctuation">.</span>temperature<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1661-每台机器的进程平均运行时间" tabindex="-1"><a class="header-anchor" href="#_1661-每台机器的进程平均运行时间" aria-hidden="true">#</a> 1661. 每台机器的进程平均运行时间</h3>`,2),q=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> a1<span class="token punctuation">.</span>machine_id<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>a2<span class="token punctuation">.</span><span class="token keyword">timestamp</span> <span class="token operator">-</span> a1<span class="token punctuation">.</span><span class="token keyword">timestamp</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> processing_time
<span class="token keyword">from</span> Activity a1 <span class="token keyword">join</span> Activity a2
<span class="token keyword">on</span> a1<span class="token punctuation">.</span>machine_id <span class="token operator">=</span> a2<span class="token punctuation">.</span>machine_id
<span class="token keyword">where</span> a1<span class="token punctuation">.</span>activity_type <span class="token operator">=</span> <span class="token string">&#39;start&#39;</span> <span class="token operator">and</span> a2<span class="token punctuation">.</span>activity_type <span class="token operator">=</span> <span class="token string">&#39;end&#39;</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> machine_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_577-员工奖金" tabindex="-1"><a class="header-anchor" href="#_577-员工奖金" aria-hidden="true">#</a> 577. 员工奖金</h3>`,2),E=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> e<span class="token punctuation">.</span>name<span class="token punctuation">,</span>b<span class="token punctuation">.</span>bonus
<span class="token keyword">from</span> Employee e <span class="token keyword">left</span> <span class="token keyword">join</span> Bonus b
<span class="token keyword">on</span> e<span class="token punctuation">.</span>empid <span class="token operator">=</span> b<span class="token punctuation">.</span>empid
<span class="token keyword">where</span> b<span class="token punctuation">.</span>bonus <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> b<span class="token punctuation">.</span>bonus <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1280-学生们参加各科测试的次数" tabindex="-1"><a class="header-anchor" href="#_1280-学生们参加各科测试的次数" aria-hidden="true">#</a> 1280. 学生们参加各科测试的次数</h3>`,2),N=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    s<span class="token punctuation">.</span>student_id<span class="token punctuation">,</span> s<span class="token punctuation">.</span>student_name<span class="token punctuation">,</span> sub<span class="token punctuation">.</span>subject_name<span class="token punctuation">,</span> IFNULL<span class="token punctuation">(</span>grouped<span class="token punctuation">.</span>attended_exams<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> attended_exams
<span class="token keyword">FROM</span> 
    Students s
<span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> 
    Subjects sub
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> student_id<span class="token punctuation">,</span> subject_name<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> attended_exams
    <span class="token keyword">FROM</span> Examinations
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> student_id<span class="token punctuation">,</span> subject_name
<span class="token punctuation">)</span> grouped 
<span class="token keyword">ON</span> s<span class="token punctuation">.</span>student_id <span class="token operator">=</span> grouped<span class="token punctuation">.</span>student_id <span class="token operator">AND</span> sub<span class="token punctuation">.</span>subject_name <span class="token operator">=</span> grouped<span class="token punctuation">.</span>subject_name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> s<span class="token punctuation">.</span>student_id<span class="token punctuation">,</span> sub<span class="token punctuation">.</span>subject_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_570-至少有5名直接下属的经理" tabindex="-1"><a class="header-anchor" href="#_570-至少有5名直接下属的经理" aria-hidden="true">#</a> 570. 至少有5名直接下属的经理</h3>`,2),O=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> name <span class="token keyword">from</span> Employee <span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> managerId <span class="token keyword">from</span> Employee <span class="token keyword">group</span> <span class="token keyword">by</span> managerId <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1934-确认率" tabindex="-1"><a class="header-anchor" href="#_1934-确认率" aria-hidden="true">#</a> 1934. 确认率</h3>`,2),S=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> s<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span>IFNULL<span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token keyword">action</span><span class="token operator">=</span><span class="token string">&#39;confirmed&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> confirmation_rate
<span class="token keyword">from</span> Signups s <span class="token keyword">left</span> <span class="token keyword">join</span> Confirmations c
<span class="token keyword">on</span> s<span class="token punctuation">.</span>user_id <span class="token operator">=</span> c<span class="token punctuation">.</span>user_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>user_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="聚合函数" tabindex="-1"><a class="header-anchor" href="#聚合函数" aria-hidden="true">#</a> 聚合函数</h2><h3 id="_620-有趣的电影" tabindex="-1"><a class="header-anchor" href="#_620-有趣的电影" aria-hidden="true">#</a> 620. 有趣的电影</h3>`,3),T=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> cinema 
<span class="token keyword">where</span> description <span class="token operator">&lt;&gt;</span> <span class="token string">&#39;boring&#39;</span> 
<span class="token operator">and</span> id <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> rating <span class="token keyword">desc</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1251-平均售价" tabindex="-1"><a class="header-anchor" href="#_1251-平均售价" aria-hidden="true">#</a> 1251. 平均售价</h3>`,2),I=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> p<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>IFNULL<span class="token punctuation">(</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span>units <span class="token operator">*</span> price<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">SUM</span><span class="token punctuation">(</span>units<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token string">&#39;average_price&#39;</span>
<span class="token keyword">from</span> Prices p <span class="token keyword">left</span> <span class="token keyword">join</span> UnitsSold u
<span class="token keyword">on</span> p<span class="token punctuation">.</span>product_id <span class="token operator">=</span> u<span class="token punctuation">.</span>product_id
<span class="token operator">and</span> u<span class="token punctuation">.</span>purchase_date <span class="token operator">between</span> p<span class="token punctuation">.</span>start_date <span class="token operator">and</span> p<span class="token punctuation">.</span>end_date
<span class="token keyword">group</span> <span class="token keyword">by</span> p<span class="token punctuation">.</span>product_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1075-项目员工-i" tabindex="-1"><a class="header-anchor" href="#_1075-项目员工-i" aria-hidden="true">#</a> 1075. 项目员工 I</h3>`,2),R=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> p<span class="token punctuation">.</span>project_id<span class="token punctuation">,</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>experience_years<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> average_years
<span class="token keyword">from</span> PROJECT <span class="token keyword">as</span> p <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> EMPLOYEE <span class="token keyword">as</span> e
<span class="token keyword">ON</span> p<span class="token punctuation">.</span>employee_id <span class="token operator">=</span> e<span class="token punctuation">.</span>employee_id
<span class="token keyword">group</span> <span class="token keyword">by</span> project_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1633-各赛事的用户注册率" tabindex="-1"><a class="header-anchor" href="#_1633-各赛事的用户注册率" aria-hidden="true">#</a> 1633. 各赛事的用户注册率</h3>`,2),C=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> 
    contest_id<span class="token punctuation">,</span><span class="token function">Round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> USERS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> percentage
<span class="token keyword">from</span> 
    Register <span class="token keyword">as</span> r
<span class="token keyword">group</span> <span class="token keyword">by</span> 
    r<span class="token punctuation">.</span>contest_id
<span class="token keyword">order</span> <span class="token keyword">by</span> 
    percentage <span class="token keyword">desc</span><span class="token punctuation">,</span>r<span class="token punctuation">.</span>contest_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1211-查询结果的质量和占比" tabindex="-1"><a class="header-anchor" href="#_1211-查询结果的质量和占比" aria-hidden="true">#</a> 1211. 查询结果的质量和占比</h3>`,2),U=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    query_name<span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">AVG</span><span class="token punctuation">(</span>rating <span class="token operator">/</span> position<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> quality<span class="token punctuation">,</span>
    <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token keyword">IF</span><span class="token punctuation">(</span>rating <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">/</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> poor_query_percentage
<span class="token keyword">FROM</span> Queries
<span class="token keyword">group</span> <span class="token keyword">by</span> query_name
<span class="token keyword">having</span> query_name <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="排序和分组" tabindex="-1"><a class="header-anchor" href="#排序和分组" aria-hidden="true">#</a> 排序和分组</h2><h3 id="_2356-每位教师所教授的科目种类的数量" tabindex="-1"><a class="header-anchor" href="#_2356-每位教师所教授的科目种类的数量" aria-hidden="true">#</a> 2356. 每位教师所教授的科目种类的数量</h3>`,3),A=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> teacher_id<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> subject_id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt
<span class="token keyword">from</span> Teacher 
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> teacher_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1141-查询近30天活跃用户数" tabindex="-1"><a class="header-anchor" href="#_1141-查询近30天活跃用户数" aria-hidden="true">#</a> 1141. 查询近30天活跃用户数</h3>`,2),L=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> activity_date <span class="token keyword">as</span> <span class="token keyword">day</span><span class="token punctuation">,</span><span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> user_id<span class="token punctuation">)</span> <span class="token keyword">as</span> active_users
<span class="token keyword">from</span> Activity
<span class="token keyword">where</span> activity_date <span class="token operator">between</span> <span class="token string">&#39;2019-06-28&#39;</span> <span class="token operator">and</span> <span class="token string">&#39;2019-07-27&#39;</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> activity_date
<span class="token keyword">order</span> <span class="token keyword">by</span> activity_date
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1084-销售分析iii" tabindex="-1"><a class="header-anchor" href="#_1084-销售分析iii" aria-hidden="true">#</a> 1084. 销售分析III</h3>`,2),D=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> s<span class="token punctuation">.</span>product_id<span class="token punctuation">,</span>p<span class="token punctuation">.</span>product_name
<span class="token keyword">from</span> Product <span class="token keyword">as</span> p <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> Sales <span class="token keyword">as</span> s
<span class="token keyword">on</span> p<span class="token punctuation">.</span>product_id <span class="token operator">=</span> s<span class="token punctuation">.</span>product_id
<span class="token keyword">group</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>product_id
<span class="token keyword">having</span>
    <span class="token function">MAX</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>sale_date<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">&#39;2019-01-01&#39;</span> <span class="token operator">and</span> <span class="token string">&#39;2019-03-31&#39;</span>
    <span class="token operator">and</span>
    <span class="token function">MIN</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>sale_date<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">&#39;2019-01-01&#39;</span> <span class="token operator">and</span> <span class="token string">&#39;2019-03-31&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_596-超过5名学生的课" tabindex="-1"><a class="header-anchor" href="#_596-超过5名学生的课" aria-hidden="true">#</a> 596. 超过5名学生的课</h3>`,2),j=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> class <span class="token keyword">from</span> Courses <span class="token keyword">group</span> <span class="token keyword">by</span> class <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> student<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_1729-求关注者的数量" tabindex="-1"><a class="header-anchor" href="#_1729-求关注者的数量" aria-hidden="true">#</a> 1729. 求关注者的数量</h3>`,2),M=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> user_id <span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span>follower_id<span class="token punctuation">)</span> followers_count
<span class="token keyword">from</span> Followers
<span class="token keyword">group</span> <span class="token keyword">by</span> user_id
<span class="token keyword">order</span> <span class="token keyword">by</span> user_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_619-只出现一次的最大数字" tabindex="-1"><a class="header-anchor" href="#_619-只出现一次的最大数字" aria-hidden="true">#</a> 619. 只出现一次的最大数字</h3>`,2),F=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">AS</span> num
<span class="token keyword">FROM</span>
    <span class="token punctuation">(</span><span class="token keyword">SELECT</span>
        num
    <span class="token keyword">FROM</span>
        MyNumbers
    <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> num
    <span class="token keyword">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="高级查询和连接" tabindex="-1"><a class="header-anchor" href="#高级查询和连接" aria-hidden="true">#</a> 高级查询和连接</h2><h3 id="_1731-每位经理的下属员工数量" tabindex="-1"><a class="header-anchor" href="#_1731-每位经理的下属员工数量" aria-hidden="true">#</a> 1731. 每位经理的下属员工数量</h3>`,3),P=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> 
    m<span class="token punctuation">.</span>employee_id<span class="token punctuation">,</span>
    m<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> reports_count<span class="token punctuation">,</span>
    <span class="token function">round</span><span class="token punctuation">(</span><span class="token function">avg</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">as</span> average_age
<span class="token keyword">from</span> Employees e 
<span class="token keyword">join</span> Employees m
<span class="token keyword">on</span> e<span class="token punctuation">.</span>reports_to <span class="token operator">=</span> m<span class="token punctuation">.</span>employee_id 
<span class="token keyword">group</span> <span class="token keyword">by</span> m<span class="token punctuation">.</span>employee_id
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_610-判断三角形" tabindex="-1"><a class="header-anchor" href="#_610-判断三角形" aria-hidden="true">#</a> 610. 判断三角形</h3>`,2),B=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
    x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>
    <span class="token keyword">CASE</span>
        <span class="token keyword">WHEN</span> x <span class="token operator">+</span> y <span class="token operator">&gt;</span> z <span class="token operator">AND</span> x <span class="token operator">+</span> z <span class="token operator">&gt;</span> y <span class="token operator">AND</span> y <span class="token operator">+</span> z <span class="token operator">&gt;</span> x <span class="token keyword">THEN</span> <span class="token string">&#39;Yes&#39;</span>
        <span class="token keyword">ELSE</span> <span class="token string">&#39;No&#39;</span>
    <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token string">&#39;triangle&#39;</span>
<span class="token keyword">FROM</span>
    triangle
<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="子查询" tabindex="-1"><a class="header-anchor" href="#子查询" aria-hidden="true">#</a> 子查询</h2><h3 id="_1978-上级经理已离职的公司员工" tabindex="-1"><a class="header-anchor" href="#_1978-上级经理已离职的公司员工" aria-hidden="true">#</a> 1978. 上级经理已离职的公司员工</h3>`,3),G=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> employee_id 
<span class="token keyword">from</span> Employees
<span class="token keyword">where</span> 
        manager_id <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span> 
    <span class="token operator">and</span> 
        manager_id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> employee_id <span class="token keyword">from</span> Employees<span class="token punctuation">)</span>  
    <span class="token operator">and</span> 
        salary <span class="token operator">&lt;</span> <span class="token number">30000</span>
<span class="token keyword">order</span> <span class="token keyword">by</span> employee_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="高级字符串函数-正则表达式-字句" tabindex="-1"><a class="header-anchor" href="#高级字符串函数-正则表达式-字句" aria-hidden="true">#</a> 高级字符串函数 / 正则表达式 / 字句</h2><h3 id="_1667-修复表中的名字" tabindex="-1"><a class="header-anchor" href="#_1667-修复表中的名字" aria-hidden="true">#</a> 1667. 修复表中的名字</h3>`,3),V=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>CONCAT<span class="token punctuation">(</span>UPPER<span class="token punctuation">(</span><span class="token keyword">left</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>LOWER<span class="token punctuation">(</span><span class="token keyword">RIGHT</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> length<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> name
<span class="token keyword">from</span> Users
<span class="token keyword">order</span> <span class="token keyword">by</span> user_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1527-患某种疾病的患者" tabindex="-1"><a class="header-anchor" href="#_1527-患某种疾病的患者" aria-hidden="true">#</a> 1527. 患某种疾病的患者</h3>`,2),H=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Patients
<span class="token keyword">where</span> conditions <span class="token operator">REGEXP</span> <span class="token string">&#39;^DIAB1| DIAB1&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_196-删除重复的电子邮箱" tabindex="-1"><a class="header-anchor" href="#_196-删除重复的电子邮箱" aria-hidden="true">#</a> 196. 删除重复的电子邮箱</h3>`,2),Y=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> p1 <span class="token keyword">FROM</span> Person p1<span class="token punctuation">,</span>
    Person p2
<span class="token keyword">WHERE</span>
    p1<span class="token punctuation">.</span>Email <span class="token operator">=</span> p2<span class="token punctuation">.</span>Email <span class="token operator">AND</span> p1<span class="token punctuation">.</span>Id <span class="token operator">&gt;</span> p2<span class="token punctuation">.</span>Id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1484-按日期分组销售产品" tabindex="-1"><a class="header-anchor" href="#_1484-按日期分组销售产品" aria-hidden="true">#</a> 1484. 按日期分组销售产品</h3>`,2),W=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> sell_date<span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> num_sold<span class="token punctuation">,</span>GROUP_CONCAT<span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> product<span class="token punctuation">)</span> products
<span class="token keyword">from</span> Activities
<span class="token keyword">group</span> <span class="token keyword">by</span> sell_date
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1327-列出指定时间段内所有的下单产品" tabindex="-1"><a class="header-anchor" href="#_1327-列出指定时间段内所有的下单产品" aria-hidden="true">#</a> 1327. 列出指定时间段内所有的下单产品</h3>`,2),z=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> p<span class="token punctuation">.</span>product_name<span class="token punctuation">,</span><span class="token function">SUM</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>unit<span class="token punctuation">)</span> unit    
<span class="token keyword">from</span> Products p <span class="token keyword">right</span> <span class="token keyword">join</span> Orders o
<span class="token keyword">on</span> p<span class="token punctuation">.</span>product_id <span class="token operator">=</span> o<span class="token punctuation">.</span>product_id
<span class="token keyword">where</span> o<span class="token punctuation">.</span>order_date <span class="token operator">between</span> <span class="token string">&#39;2020-02-01&#39;</span> <span class="token operator">and</span> <span class="token string">&#39;2020-02-29&#39;</span>
<span class="token keyword">group</span> <span class="token keyword">by</span> p<span class="token punctuation">.</span>product_name
<span class="token keyword">having</span> <span class="token function">SUM</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>unit<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">100</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1517-查找拥有有效邮箱的用户" tabindex="-1"><a class="header-anchor" href="#_1517-查找拥有有效邮箱的用户" aria-hidden="true">#</a> 1517. 查找拥有有效邮箱的用户</h3>`,2),J=a(`<div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> user_id<span class="token punctuation">,</span>name<span class="token punctuation">,</span>mail <span class="token keyword">from</span> users <span class="token keyword">where</span> mail <span class="token operator">regexp</span> <span class="token string">&#39;^[a-zA-Z][0-9a-zA-Z\\-\\_\\\\.]*@leetcode\\\\.com$&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,1);function Q(X,Z){const o=p("ExternalLinkIcon"),n=p("Badge");return i(),l("div",null,[r,e("p",null,[e("a",u,[t("题目集合"),s(o)])]),k,v,s(n,{text:"简单",type:"tip",vertical:"middle"}),m,s(n,{text:"简单",type:"tip",vertical:"middle"}),b,s(n,{text:"简单",type:"tip",vertical:"middle"}),h,s(n,{text:"简单",type:"tip",vertical:"middle"}),y,s(n,{text:"简单",type:"tip",vertical:"middle"}),_,s(n,{text:"简单",type:"tip",vertical:"middle"}),w,s(n,{text:"简单",type:"tip",vertical:"middle"}),g,s(n,{text:"简单",type:"tip",vertical:"middle"}),f,s(n,{text:"简单",type:"tip",vertical:"middle"}),x,s(n,{text:"简单",type:"tip",vertical:"middle"}),q,s(n,{text:"简单",type:"tip",vertical:"middle"}),E,s(n,{text:"简单",type:"tip",vertical:"middle"}),N,s(n,{text:"中等",type:"warning",vertical:"middle"}),O,s(n,{text:"中等",type:"warning",vertical:"middle"}),S,s(n,{text:"简单",type:"tip",vertical:"middle"}),T,s(n,{text:"简单",type:"tip",vertical:"middle"}),I,s(n,{text:"简单",type:"tip",vertical:"middle"}),R,s(n,{text:"简单",type:"tip",vertical:"middle"}),C,s(n,{text:"简单",type:"tip",vertical:"middle"}),U,s(n,{text:"简单",type:"tip",vertical:"middle"}),A,s(n,{text:"简单",type:"tip",vertical:"middle"}),L,s(n,{text:"简单",type:"tip",vertical:"middle"}),D,s(n,{text:"简单",type:"tip",vertical:"middle"}),j,s(n,{text:"简单",type:"tip",vertical:"middle"}),M,s(n,{text:"简单",type:"tip",vertical:"middle"}),F,s(n,{text:"简单",type:"tip",vertical:"middle"}),P,s(n,{text:"简单",type:"tip",vertical:"middle"}),B,s(n,{text:"简单",type:"tip",vertical:"middle"}),G,s(n,{text:"简单",type:"tip",vertical:"middle"}),V,s(n,{text:"简单",type:"tip",vertical:"middle"}),H,s(n,{text:"简单",type:"tip",vertical:"middle"}),Y,s(n,{text:"简单",type:"tip",vertical:"middle"}),W,s(n,{text:"简单",type:"tip",vertical:"middle"}),z,s(n,{text:"简单",type:"tip",vertical:"middle"}),J])}const ss=c(d,[["render",Q],["__file","高频 SQL 50 题（基础版）.html.vue"]]);export{ss as default};
